<?php
/**
 *  Implementation of hook_menu()
 */

function confirm_popup_menu(){

//Example link 
$items['exampleconfirmform'] = array(
      'title' => 'exampleconfirmform',
      'page callback' => 'exampleconfirmform',
      'access callback' => TRUE,
      'type' => MENU_NORMAL_ITEM,
  );
 
 //Menu to handle ajax request for the confirmation form
$items['cajaxform/%'] = array(
      'title' => 'cajaxform',
      'page callback' => 'cajaxform',
	  'page arguments' => array('example_form', 1),
      'access callback' => TRUE,
      'type' => MENU_CALLBACK,
  ); 
  return $items;
}

/**
 *  Function to preprocess link to add ctools processed class
 */
function cl($text, $link, $alt){
	ctools_include('ajax');
	ctools_include('modal');
	ctools_modal_add_js();
	return ctools_modal_text_button(t($text), $link, t($alt));
}

/**
 *  Callback function to handle ajax request
 */
function cajaxform($form_id, $nodeid){
$args = func_get_args();
unset($args[0]);
// Include the CTools tools that we need.
  ctools_include('ajax');
  ctools_include('modal');
  ctools_modal_add_js();
       $form_state = array(
    'title' => t('Example Confirmation form'),
    'ajax' => TRUE,
	'args' => $args,
  );

 $output = ctools_modal_form_wrapper($form_id, $form_state);
 $refresh = FALSE;
   if (empty($output)) {
    // empty $output signifies success, so we'll use it as our $commands
    // array.
    $output = array();
    $message =  theme('status_messages');
    $output[] = ctools_modal_command_display(t('Message'), "<div>".$message."</div>");

	
  }
  ctools_ajax_render($output);
  
}


//Example confirmation form
function example_form(&$form_state, $test){
	  $form = array(
    'test1' => array('#type' => 'value', '#value' => 'test'),
  );
  $confirmation_message = t('Are you sure you want to  dele.');
  $cancel_path = $test;
  return confirm_form($form, $confirmation_message, $cancel_path);
	
}

function example_form_submit($form, &$form_state){
	 
	   $test1 = $form_state['values']['test1'];
	 drupal_set_message('Confirmation message'. $test1);
}

function exampleconfirmform(){
 return cl('testlink', 'cajaxform/1', 'testalt');
}